<html>
  <head>
    <title>Sandbox Test</title>
    <meta charset="UTF-8" />
    <style>
      iframe {
        display: block;
        border: none;
        height: 100vh;
        width: 100vw;
      }

      body{
        margin: 0;
        padding: 0;
      }

    </style>
  </head>

  <body>
    

    <div id="player"></div>

    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous">
    </script>
    <script>

setTimeout(function(){

const tag = document.createElement('script')
tag.src = 'https://www.youtube.com/iframe_api'
const firstScriptTag = document.getElementsByTagName('script')[0]
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)

  
},10000);


let player;

const onApiChange = _ => {   
  if (typeof player.setOption === 'function') {
    player.setOption('captions', 'track', {languageCode: 'ko'})
  }  
}

const onReady = _ => {   
  player.playVideo()
}

function onYouTubePlayerAPIReady() {
  player = new YT.Player('player', {
    height: '360',
    width: '640',
    //videoId: '4kh1FHjKii8',
    playerVars: {
      cc_lang_pref: 'ko',
      cc_load_policy: 1,
      autoplay : 1,
      mute : 1,
      listType : 'playList',
      list : 'PLuvOuATgTn16DHQbVz48526ZOIEde1d9e'
    },
    events: {
      onReady,
      onApiChange,
      'onStateChange': onPlayerStateChange,
      'onError': onPlayerError
    }
  })
}

function onPlayerStateChange(event) {

    console.log(event.data)

    if(event.data == 0){

      window.location.reload()
    }
}

function onPlayerError(e){
  window.location.reload()
}


    setInterval(function() {
      if (!navigator.onLine){
          location.href = "file:///Users/mogi/diabloapp/localhost.html";
      }
    }, 1000);


    </script>
  </body>
</html>
